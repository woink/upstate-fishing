import{a as e}from"./chunk-BCE34AQ5.js";import{a as f,d as l}from"./chunk-TI4L7M5E.js";import"./chunk-CFTXCTKY.js";var h={excellent:"bg-green-100 border-green-500 text-green-800",good:"bg-blue-100 border-blue-500 text-blue-800",fair:"bg-yellow-100 border-yellow-500 text-yellow-800",poor:"bg-red-100 border-red-500 text-red-800"},v={excellent:"\u{1F3AF} Excellent",good:"\u{1F44D} Good",fair:"\u26A0\uFE0F Fair",poor:"\u274C Poor"};function b({apiUrl:o}){let n=l([]),d=l(!0),r=l(null);return f(()=>{async function t(){d.value=!0,r.value=null;try{let a=await(await fetch(`${o}/api/streams`)).json();if(!a.success||!a.data)throw new Error("Failed to fetch streams");let g=a.data.slice(0,6).map(async i=>{try{let p=await(await fetch(`${o}/api/streams/${i.id}/conditions`)).json();return p.success?p.data:null}catch{return null}}),c=(await Promise.all(g)).filter(i=>i!==null),u={excellent:0,good:1,fair:2,poor:3};c.sort((i,m)=>u[i.fishingQuality]-u[m.fishingQuality]),n.value=c.slice(0,3)}catch(s){r.value=s instanceof Error?s.message:"Failed to load"}finally{d.value=!1}}t()},[o]),d.value?e("div",{class:"bg-white rounded-lg shadow p-8 text-center",children:[e("div",{class:"animate-pulse flex flex-col items-center",children:[e("div",{class:"w-12 h-12 bg-slate-200 rounded-full mb-4"}),e("div",{class:"h-4 bg-slate-200 rounded w-48"})]}),e("p",{class:"text-slate-500 mt-4",children:"Checking conditions..."})]}):r.value?e("div",{class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e("p",{class:"text-red-700",children:r.value}),e("button",{onClick:()=>window.location.reload(),class:"mt-2 text-red-600 underline",children:"Retry"})]}):n.value.length===0?e("div",{class:"bg-slate-100 rounded-lg p-6 text-center",children:e("p",{class:"text-slate-600",children:"No conditions data available"})}):e("div",{children:[e("h2",{class:"text-xl font-semibold text-slate-800 mb-4",children:"\u{1F3A3} Today's Top Picks"}),e("div",{class:"grid md:grid-cols-3 gap-4",children:n.value.map((t,s)=>e("a",{href:`/streams/${t.stream.id}`,class:`block rounded-lg border-l-4 p-4 shadow hover:shadow-md transition ${h[t.fishingQuality]}`,children:[e("div",{class:"flex items-start justify-between mb-2",children:[e("h3",{class:"font-semibold",children:t.stream.name}),s===0&&e("span",{class:"text-lg",children:"\u2B50"})]}),e("div",{class:"text-sm space-y-1 mb-3",children:[t.stationData[0]?.waterTempF&&e("p",{children:["\u{1F4A7} Water: ",t.stationData[0].waterTempF,"\xB0F"]}),t.weather&&e("p",{children:["\u{1F321}\uFE0F Air: ",t.weather.airTempF,"\xB0F"]}),t.stationData[0]?.dischargeCfs&&e("p",{children:["\u{1F30A} Flow: ",t.stationData[0].dischargeCfs," cfs"]})]}),t.predictedHatches.length>0&&e("div",{class:"text-xs",children:[e("span",{class:"font-medium",children:"Likely hatches: "}),t.predictedHatches.slice(0,2).map(a=>a.hatch.commonName).join(", ")]}),e("div",{class:"mt-2 text-xs font-medium",children:v[t.fishingQuality]})]},t.stream.id))})]})}export{b as default};
